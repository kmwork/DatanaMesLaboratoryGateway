2020-04-09 19:14:31.615  INFO 8781 --- [main] ru.datana.steel.mes.DevJmsApp            : Starting DevJmsApp on lin-pc with PID 8781 (/home/lin/work-lanit/DatanaMesGateway-K9/target/classes started by lin in /home/lin/work-lanit/DatanaMesGateway-K9)
2020-04-09 19:14:31.616 DEBUG 8781 --- [main] ru.datana.steel.mes.DevJmsApp            : Running with Spring Boot v2.2.6.RELEASE, Spring v5.2.5.RELEASE
2020-04-09 19:14:31.617  INFO 8781 --- [main] ru.datana.steel.mes.DevJmsApp            : No active profile set, falling back to default profiles: default
2020-04-09 19:14:32.445  INFO 8781 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-04-09 19:14:32.469  INFO 8781 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 16ms. Found 0 JPA repository interfaces.
2020-04-09 19:14:32.797  INFO 8781 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2020-04-09 19:14:32.994  INFO 8781 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2020-04-09 19:14:33.031  INFO 8781 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-04-09 19:14:33.067  INFO 8781 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.4.12.Final
2020-04-09 19:14:33.162  INFO 8781 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.0.Final}
2020-04-09 19:14:33.223  INFO 8781 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: ru.datana.steel.mes.db.DatanaJsonPostgreSQLDialect
2020-04-09 19:14:33.340  INFO 8781 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-04-09 19:14:33.345  INFO 8781 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-04-09 19:14:33.356  INFO 8781 --- [main] r.d.steel.mes.util.DatanaXmlValidator    : [XML-Validator] Чтение xsd схемы
2020-04-09 19:14:33.357  INFO 8781 --- [main] r.d.steel.mes.util.DatanaXmlValidator    : [Схема] schemaFile = /home/lin/work-lanit/DatanaMesGateway-K9/etc/input-xsd-schema.xsd
2020-04-09 19:14:33.461 DEBUG 8781 --- [main] r.datana.steel.mes.db.CallDbServiceImpl  : [SQL:Init:Save] pgNativeSaveSQL = select cast (datalake.mes_chemical_composition_save(cast(:fromXml as xml)) as text)
2020-04-09 19:14:33.461  INFO 8781 --- [main] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] Запуск JMS-сервиса.
2020-04-09 19:14:33.463  INFO 8781 --- [main] ru.datana.steel.mes.config.SpringConfig  : [Safe:CONFIG] APP VERSION = Datana-MES-Gateway-V2020-04-09_BEGIN
2020-04-09 19:14:33.472  INFO 8781 --- [main] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] Запуск JMS-сервиса.
2020-04-09 19:14:33.705  INFO 8781 --- [main] ru.datana.steel.mes.DevJmsApp            : Started DevJmsApp in 2.486 seconds (JVM running for 3.208)
2020-04-09 19:14:38.700 ERROR 8781 --- [listenerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Could not refresh JMS Connection for destination 'queue://jmsFromMes' - retrying using FixedBackOff{interval=5000, currentAttempts=0, maxAttempts=unlimited}. Cause: Could not connect to broker URL: tcp://localhost:61616. Reason: java.net.ConnectException: В соединении отказано
2020-04-09 19:14:43.704 ERROR 8781 --- [listenerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Could not refresh JMS Connection for destination 'queue://jmsFromMes' - retrying using FixedBackOff{interval=5000, currentAttempts=1, maxAttempts=unlimited}. Cause: Could not connect to broker URL: tcp://localhost:61616. Reason: java.net.ConnectException: В соединении отказано
2020-04-09 19:14:48.707 ERROR 8781 --- [listenerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Could not refresh JMS Connection for destination 'queue://jmsFromMes' - retrying using FixedBackOff{interval=5000, currentAttempts=2, maxAttempts=unlimited}. Cause: Could not connect to broker URL: tcp://localhost:61616. Reason: java.net.ConnectException: В соединении отказано
2020-04-09 19:14:53.711 ERROR 8781 --- [listenerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Could not refresh JMS Connection for destination 'queue://jmsFromMes' - retrying using FixedBackOff{interval=5000, currentAttempts=3, maxAttempts=unlimited}. Cause: Could not connect to broker URL: tcp://localhost:61616. Reason: java.net.ConnectException: В соединении отказано
2020-04-09 19:14:58.715 ERROR 8781 --- [listenerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Could not refresh JMS Connection for destination 'queue://jmsFromMes' - retrying using FixedBackOff{interval=5000, currentAttempts=4, maxAttempts=unlimited}. Cause: Could not connect to broker URL: tcp://localhost:61616. Reason: java.net.ConnectException: В соединении отказано
2020-04-09 19:15:03.720 ERROR 8781 --- [listenerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Could not refresh JMS Connection for destination 'queue://jmsFromMes' - retrying using FixedBackOff{interval=5000, currentAttempts=5, maxAttempts=unlimited}. Cause: Could not connect to broker URL: tcp://localhost:61616. Reason: java.net.ConnectException: В соединении отказано
2020-04-09 19:15:08.724 ERROR 8781 --- [listenerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Could not refresh JMS Connection for destination 'queue://jmsFromMes' - retrying using FixedBackOff{interval=5000, currentAttempts=6, maxAttempts=unlimited}. Cause: Could not connect to broker URL: tcp://localhost:61616. Reason: java.net.ConnectException: В соединении отказано
2020-04-09 19:15:13.738 ERROR 8781 --- [listenerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Could not refresh JMS Connection for destination 'queue://jmsFromMes' - retrying using FixedBackOff{interval=5000, currentAttempts=7, maxAttempts=unlimited}. Cause: Could not connect to broker URL: tcp://localhost:61616. Reason: java.net.ConnectException: В соединении отказано
2020-04-09 19:16:01.607  INFO 8781 --- [listenerContainer-2] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] [onMessage]input message = 111
2020-04-09 19:16:01.623 ERROR 8781 --- [listenerContainer-2] r.d.steel.mes.util.DatanaXmlValidator    : [App-Ошибка] SAXException: Не валиный xml: Content is not allowed in prolog.
2020-04-09 19:16:01.624  INFO 8781 --- [listenerContainer-2] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] [onMessage]input message = 111
2020-04-09 19:16:01.643 ERROR 8781 --- [listenerContainer-2] ru.datana.steel.mes.util.XPathUtil       : [App-Ошибка] Ошибка при XPATH разбора по XPATH для xml = 111
2020-04-09 19:16:01.654 ERROR 8781 --- [listenerContainer-2] ru.datana.steel.mes.util.XPathUtil       : [App-Ошибка] В запросе нет поля ID по xpath = /MESChemicalCompositionSave/messageID
2020-04-09 19:16:01.654 DEBUG 8781 --- [listenerContainer-2] r.d.steel.mes.jms.MesJmsProducerImpl     : [JMS:Producer] [Queue:jmsFromMesToError]  вызов метода Method:Отправка ошибок
2020-04-09 19:16:01.708  INFO 8781 --- [listenerContainer-2] r.d.steel.mes.jms.MesJmsProducerImpl     : [JMS:Producer] [Queue:jmsFromMesToError] Отправлен в очередь = jmsFromMesToError, xmlAsStringMsg = SAXException: Не валиный xml: Content is not allowed in prolog.
2020-04-09 19:18:38.751  INFO 8781 --- [SpringContextShutdownHook] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] Остановка JMS-сервиса.
2020-04-09 19:18:38.761  INFO 8781 --- [SpringContextShutdownHook] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] Остановка JMS-сервиса.
2020-04-09 19:18:38.762  INFO 8781 --- [SpringContextShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-04-09 19:18:38.765  INFO 8781 --- [SpringContextShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2020-04-09 19:18:38.779  INFO 8781 --- [SpringContextShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2020-04-09 19:19:28.619  INFO 9500 --- [main] ru.datana.steel.mes.DevJmsApp            : Starting DevJmsApp on lin-pc with PID 9500 (/home/lin/work-lanit/DatanaMesGateway-K9/target/classes started by lin in /home/lin/work-lanit/DatanaMesGateway-K9)
2020-04-09 19:19:28.620 DEBUG 9500 --- [main] ru.datana.steel.mes.DevJmsApp            : Running with Spring Boot v2.2.6.RELEASE, Spring v5.2.5.RELEASE
2020-04-09 19:19:28.621  INFO 9500 --- [main] ru.datana.steel.mes.DevJmsApp            : No active profile set, falling back to default profiles: default
2020-04-09 19:19:29.435  INFO 9500 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-04-09 19:19:29.456  INFO 9500 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 14ms. Found 0 JPA repository interfaces.
2020-04-09 19:19:30.094  INFO 9500 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2020-04-09 19:19:30.280  INFO 9500 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2020-04-09 19:19:30.322  INFO 9500 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-04-09 19:19:30.359  INFO 9500 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.4.12.Final
2020-04-09 19:19:30.445  INFO 9500 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.0.Final}
2020-04-09 19:19:30.513  INFO 9500 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: ru.datana.steel.mes.db.DatanaJsonPostgreSQLDialect
2020-04-09 19:19:30.624  INFO 9500 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-04-09 19:19:30.629  INFO 9500 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-04-09 19:19:30.636  INFO 9500 --- [main] r.d.steel.mes.util.DatanaXmlValidator    : [XML-Validator] Чтение xsd схемы
2020-04-09 19:19:30.637  INFO 9500 --- [main] r.d.steel.mes.util.DatanaXmlValidator    : [Схема] schemaFile = /home/lin/work-lanit/DatanaMesGateway-K9/etc/input-xsd-schema.xsd
2020-04-09 19:19:30.738 DEBUG 9500 --- [main] r.datana.steel.mes.db.CallDbServiceImpl  : [SQL:Init:Save] pgNativeSaveSQL = select cast (datalake.mes_chemical_composition_save(cast(:fromXml as xml)) as text)
2020-04-09 19:19:30.739  INFO 9500 --- [main] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] Запуск JMS-сервиса.
2020-04-09 19:19:30.741  INFO 9500 --- [main] ru.datana.steel.mes.config.SpringConfig  : [Safe:CONFIG] APP VERSION = Datana-MES-Gateway-V2020-04-09_BEGIN
2020-04-09 19:19:30.755  INFO 9500 --- [main] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] Запуск JMS-сервиса.
2020-04-09 19:19:30.994  INFO 9500 --- [main] ru.datana.steel.mes.DevJmsApp            : Started DevJmsApp in 2.711 seconds (JVM running for 3.355)
2020-04-09 19:19:56.313  INFO 9500 --- [listenerContainer-1] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] [onMessage] input message = Enter some text here for the message body...3453454545454545
2020-04-09 19:19:56.333 ERROR 9500 --- [listenerContainer-1] r.d.steel.mes.util.DatanaXmlValidator    : [App-Ошибка] SAXException: Не валиный xml: Content is not allowed in prolog.
2020-04-09 19:19:56.335  INFO 9500 --- [listenerContainer-1] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] [onMessage] input message = Enter some text here for the message body...3453454545454545
2020-04-09 19:19:56.345 DEBUG 9500 --- [listenerContainer-1] r.d.steel.mes.jms.MesJmsProducerImpl     : [JMS:Producer] [Queue:jmsFromMesToError]  вызов метода Method:Отправка ошибок
2020-04-09 19:19:56.360  INFO 9500 --- [listenerContainer-1] r.d.steel.mes.jms.MesJmsProducerImpl     : [JMS:Producer] [Queue:jmsFromMesToError] Отправлен в очередь = jmsFromMesToError, xmlAsStringMsg = SAXException: Не валиный xml: Content is not allowed in prolog.
2020-04-09 19:21:48.569  INFO 9500 --- [listenerContainer-1] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] [onMessage] input message = <?xml version="1.0" encoding="UTF-8"?>
<tns:MESChemicalCompositionSave xmlns:tns="http://datana.ru/publishing">
    <messageID>8c28810c-d867-4b3f-a6af-ec3541414741</messageID>
    <smeltingNumber>sampleNumber0</smeltingNumber>
    <sampleNumber>sampleNumber0</sampleNumber>
    <samplingDatetime>2006-05-04T18:13:51.0</samplingDatetime>
    <sampleAnalysisDatetime>2006-05-04T18:13:51.0</sampleAnalysisDatetime>
    <compositionType>STEEL</compositionType>
    <unitName>UVS2</unitName>
    <controlledElementsAnalysisResults>
        <controlledElementItem>
            <controlledElementName>SIO2</controlledElementName>
            <controlledElementValue>0.2345</controlledElementValue>
        </controlledElementItem>
        <controlledElementItem>
            <controlledElementName>TI</controlledElementName>
            <controlledElementValue>0.23556</controlledElementValue>
        </controlledElementItem>
    </controlledElementsAnalysisResults>
</tns:MESChemicalCompositionSave>
2020-04-09 19:21:48.576 ERROR 9500 --- [listenerContainer-1] r.d.steel.mes.util.DatanaXmlValidator    : [App-Ошибка] SAXException: Не валиный xml: cvc-complex-type.2.4.a: Invalid content was found starting with element 'controlledElementName'. One of '{сontrolledElementName}' is expected.
2020-04-09 19:21:48.576  INFO 9500 --- [listenerContainer-1] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] [onMessage] input message = <?xml version="1.0" encoding="UTF-8"?>
<tns:MESChemicalCompositionSave xmlns:tns="http://datana.ru/publishing">
    <messageID>8c28810c-d867-4b3f-a6af-ec3541414741</messageID>
    <smeltingNumber>sampleNumber0</smeltingNumber>
    <sampleNumber>sampleNumber0</sampleNumber>
    <samplingDatetime>2006-05-04T18:13:51.0</samplingDatetime>
    <sampleAnalysisDatetime>2006-05-04T18:13:51.0</sampleAnalysisDatetime>
    <compositionType>STEEL</compositionType>
    <unitName>UVS2</unitName>
    <controlledElementsAnalysisResults>
        <controlledElementItem>
            <controlledElementName>SIO2</controlledElementName>
            <controlledElementValue>0.2345</controlledElementValue>
        </controlledElementItem>
        <controlledElementItem>
            <controlledElementName>TI</controlledElementName>
            <controlledElementValue>0.23556</controlledElementValue>
        </controlledElementItem>
    </controlledElementsAnalysisResults>
</tns:MESChemicalCompositionSave>
2020-04-09 19:21:48.576 DEBUG 9500 --- [listenerContainer-1] r.d.steel.mes.jms.MesJmsProducerImpl     : [JMS:Producer] [Queue:jmsFromMesToError]  вызов метода Method:Отправка ошибок
2020-04-09 19:21:48.582  INFO 9500 --- [listenerContainer-1] r.d.steel.mes.jms.MesJmsProducerImpl     : [JMS:Producer] [Queue:jmsFromMesToError] Отправлен в очередь = jmsFromMesToError, xmlAsStringMsg = SAXException: Не валиный xml: cvc-complex-type.2.4.a: Invalid content was found starting with element 'controlledElementName'. One of '{сontrolledElementName}' is expected.
2020-04-09 19:23:30.289  INFO 9500 --- [listenerContainer-1] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] [onMessage] input message = <?xml version="1.0" encoding="utf-8"?>
<tns:MESChemicalCompositionSave xmlns:tns="http://datana.ru/publishing">
    <messageID>8c28810c-d867-4b3f-a6af-ec3541414741--uuid</messageID>
    <smeltingNumber>str1234</smeltingNumber>
    <sampleNumber>str1234</sampleNumber>
    <samplingDatetime>2012-12-13T12:12:12</samplingDatetime>
    <sampleAnalysisDatetime>2012-12-13T12:12:12</sampleAnalysisDatetime>
    <compositionType>STEEL</compositionType>
    <unitName>str1234</unitName>
    <controlledElementsAnalysisResults>
        <controlledElementItem>
            <сontrolledElementName>C</сontrolledElementName>
            <сontrolledElementValue>123.45</сontrolledElementValue>
        </controlledElementItem>
    </controlledElementsAnalysisResults>
</tns:MESChemicalCompositionSave>
2020-04-09 19:23:30.290  INFO 9500 --- [listenerContainer-1] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] [onMessage] input message = <?xml version="1.0" encoding="utf-8"?>
<tns:MESChemicalCompositionSave xmlns:tns="http://datana.ru/publishing">
    <messageID>8c28810c-d867-4b3f-a6af-ec3541414741--uuid</messageID>
    <smeltingNumber>str1234</smeltingNumber>
    <sampleNumber>str1234</sampleNumber>
    <samplingDatetime>2012-12-13T12:12:12</samplingDatetime>
    <sampleAnalysisDatetime>2012-12-13T12:12:12</sampleAnalysisDatetime>
    <compositionType>STEEL</compositionType>
    <unitName>str1234</unitName>
    <controlledElementsAnalysisResults>
        <controlledElementItem>
            <сontrolledElementName>C</сontrolledElementName>
            <сontrolledElementValue>123.45</сontrolledElementValue>
        </controlledElementItem>
    </controlledElementsAnalysisResults>
</tns:MESChemicalCompositionSave>
2020-04-09 19:23:30.325  INFO 9500 --- [listenerContainer-1] ru.datana.steel.mes.jms.MesJmsListener   : [JMS:Listener] ID полученного сообщения = 8c28810c-d867-4b3f-a6af-ec3541414741--uuid
2020-04-09 19:23:30.326 DEBUG 9500 --- [listenerContainer-1] r.datana.steel.mes.db.CallDbServiceImpl  : [SQL:Save] data = <?xml version="1.0" encoding="utf-8"?>
<tns:MESChemicalCompositionSave xmlns:tns="http://datana.ru/publishing">
    <messageID>8c28810c-d867-4b3f-a6af-ec3541414741--uuid</messageID>
    <smeltingNumber>str1234</smeltingNumber>
    <sampleNumber>str1234</sampleNumber>
    <samplingDatetime>2012-12-13T12:12:12</samplingDatetime>
    <sampleAnalysisDatetime>2012-12-13T12:12:12</sampleAnalysisDatetime>
    <compositionType>STEEL</compositionType>
    <unitName>str1234</unitName>
    <controlledElementsAnalysisResults>
        <controlledElementItem>
            <сontrolledElementName>C</сontrolledElementName>
            <сontrolledElementValue>123.45</сontrolledElementValue>
        </controlledElementItem>
    </controlledElementsAnalysisResults>
</tns:MESChemicalCompositionSave>
2020-04-09 19:23:30.476  INFO 9500 --- [listenerContainer-1] r.datana.steel.mes.db.CallDbServiceImpl  : [SQL:Save] результат = <MESChemicalCompositionSaveResult>
  <status>OK</status>
</MESChemicalCompositionSaveResult>
2020-04-09 19:23:30.495 DEBUG 9500 --- [listenerContainer-1] r.d.steel.mes.jms.MesJmsProducerImpl     : [JMS:Producer] [Queue:jmsResponseFromDatanaToMes]  вызов метода Method:Отправка ответов при успехе
2020-04-09 19:23:30.508  INFO 9500 --- [listenerContainer-1] r.d.steel.mes.jms.MesJmsProducerImpl     : [JMS:Producer] [Queue:jmsResponseFromDatanaToMes] Отправлен в очередь = jmsResponseFromDatanaToMes, xmlAsStringMsg = <MESChemicalCompositionSaveResult>
  <status>OK</status>
</MESChemicalCompositionSaveResult>
2020-04-09 19:23:30.508  INFO 9500 --- [listenerContainer-1] ru.datana.steel.mes.jms.MesJmsListener   : [App-Успешно] Сообщение обработано c Id = 8c28810c-d867-4b3f-a6af-ec3541414741--uuid
